---
phase: 03-adapter-layer
plan: 01
type: execute
wave: 1
depends_on: []
files_modified: [get-shit-done/references/adapter-architecture.md, README.md]
autonomous: true
---

<objective>
Verify shared core is client-agnostic and document the adapter architecture.

Purpose: Ensure workflows, references, and templates can be used by both Claude Code and OpenCode without modification. Create clear documentation for the adapter pattern.
Output: Adapter architecture reference document and verified client-agnostic core.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/01-jj-foundation/01-01-SUMMARY.md
@.planning/phases/02-core-workflows/02-06-SUMMARY.md

@get-shit-done/references/jj-integration.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Audit shared core for hardcoded client paths</name>
  <files>get-shit-done/workflows/*.md, get-shit-done/references/*.md, get-shit-done/templates/*.md</files>
  <action>
    Grep all files in get-shit-done/ for hardcoded paths:
    - `~/.claude/` - Claude Code specific
    - `~/.config/opencode/` - OpenCode specific

    Identify any hardcoded paths that would break cross-client usage.

    Expected result: Most files should use relative paths or generic references.
    The `@~/.claude/get-shit-done/` pattern in execution_context sections is intentional -
    these are resolved at runtime by the client's slash command system.

    If hardcoded problematic paths found, document them for resolution in Plan 02.
  </action>
  <verify>grep -r "\.claude\|\.config/opencode" get-shit-done/ | wc -l shows expected count</verify>
  <done>Audit complete, any problematic hardcoded paths documented</done>
</task>

<task type="auto">
  <name>Task 2: Create adapter architecture reference document</name>
  <files>get-shit-done/references/adapter-architecture.md</files>
  <action>
    Create adapter-architecture.md documenting:

    1. **Architecture Overview**: Shared core + client adapters pattern
    2. **Directory Structure**:
       - `get-shit-done/` - Shared core (workflows, references, templates)
       - `commands/gsd/` - Claude Code adapter (commands)
       - `adapters/opencode/command/gsd/` - OpenCode adapter (commands)
    3. **Path Resolution**:
       - Claude Code: `~/.claude/get-shit-done/...`
       - OpenCode: `~/.config/opencode/get-shit-done/...`
    4. **Adapter Responsibilities**:
       - Parse slash command arguments
       - Resolve paths for the target client
       - Call shared workflows/templates
    5. **Adding New Commands**:
       - Create command in commands/gsd/ for Claude Code
       - Port to adapters/opencode/ with path adjustments

    Use markdown with clear sections. No XML needed for reference docs.
  </action>
  <verify>cat get-shit-done/references/adapter-architecture.md | head -50 shows structure</verify>
  <done>Adapter architecture document created with all sections</done>
</task>

<task type="auto">
  <name>Task 3: Update project README with adapter layer info</name>
  <files>README.md</files>
  <action>
    Update the main README.md to document:

    1. Add "Supported Clients" section listing Claude Code and OpenCode
    2. Add brief explanation of adapter architecture
    3. Link to adapter-architecture.md for details
    4. Keep existing JJ-focused content

    Do NOT remove existing content. Add new sections appropriately.
  </action>
  <verify>grep -c "Supported Clients" README.md returns 1</verify>
  <done>README updated with adapter layer documentation</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] Audit of shared core completed
- [ ] adapter-architecture.md created and committed
- [ ] README.md updated with client support info
- [ ] All changes committed atomically
</verification>

<success_criteria>

- Shared core verified as client-agnostic (or issues documented)
- Adapter architecture clearly documented
- README reflects multi-client support
- All tasks completed with atomic commits
</success_criteria>

<output>
After completion, create `.planning/phases/03-adapter-layer/03-01-SUMMARY.md`
</output>
